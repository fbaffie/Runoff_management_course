---
title: "Exercises: hydrological processes"
author: Back to [course overview](../index.html#exercise-sessions)
output:
  rmdshower::shower_presentation:
    self_contained: false
    katex: true
    ratio: 16x10
    theme: material
    lib_dir: ../
---

## Hydrological processes

In this exercise session we will practice concepts covered in class:
- Infiltration
- Groundwater flow
- Evaporation
- Snowmelt and glacier melt



## [Steady flow in an unconfined aquifer](http://www.geo.citg.tudelft.nl/~uffink/syllabusCT3320/part1/6.1/6.1.html)

> - **Most aquifers are thin and quite flat. Which flow direction can we neglect?**
> - We can neglect vertical flow. Groundwater is hydrostatic (vertical equipotential lines)
> - Groundwater discharge is proportional to the depth of the aquifer
> - This is the Dupuit–Forchheimer assumption

<img src="images/unconfined_aquifer_ex.gif" height="300" width="auto">

## Find Q as a function of $K$, L, $\phi_1$ and $\phi_2$

> 1. **Express Q as a function of h and q (flow per unit area)**
> 1. **Use the conservation of mass across each $dx$ slice of aquifer**
> 1. **With the reference level as the base of the aquifer ($\phi = h$), write Darcy's Law**
> 1. **Combine 2 and 3**
> 1. **We assume that *K* is uniform, integrate, and express $h^2$ and $h$ as a function of x, L, $\phi_1$ and $\phi_2$**
> 1. **Using steps 1 and 3, we want to express $Q$ without $x$**
> 1. Finally we have: $Q = -K\frac{(\phi_2^2-\phi_1^2)}{2L}$


# Groundwater recession

## Modelling recession dynamics

$Q = Q_{0} * e^{-ct}$

$c$ is the recession constant.

Groundwater recession would be a function of some (average) measure of hydraulic head:

$Q = f(h(t))$

If the aquifer is 1m wide, has a length L, and a storativity or specific yield S, then we can write:

$SL \frac{dh}{dt} = -q_r = -f(h(t))$

Proportionality between h and qr:

$q_r = cSLh(t)$

and by substituting we get

$\frac{dh}{dt} = -ch$

which then integrated gives:*

$h = h_0 * e^{-ct}$

where h0 is the average hydraulic head at the initial time.
Then from the proportionality relation we have:

$q_r = cSL * h_0 * e^{-ct}$

or 

$Q_r = Q_{r0} * e^{-ct}$

So the use of the first equation implies that the groundwater reservoir behaves as a linear reservoir, the GW outflow is proportional the amount of water stored.

This tool can be usefull to estimate flow throughout a dry season.

# Field intuition and modelling: conceptual modelling of surface / groundwater interactions

## Conceptual view of my PhD catchment
<img src="../01_Hydrology/images/phd/Paper 4 - Figure 7.png" height="450" width="auto">

## Electrical conductivity: natural tracer
<img src="../01_Hydrology/images/phd/Paper 4 - Figure 1.png" height="450" width="auto">

<!--
> - **From this graph, what can you tell about the relationship between electrical conductivity and streamflow?**
> - There is an inverse proportionality which seems to depend on the season and the discharge.
> - **From this graph, what can you tell about the relationship between stream stage and groundwater stage near and far from the stream?**
> - **Cite another example where such dynamics happen on a daily basis. (tip: this is linked to a another periodical natural phenomenon)**
-->

## Initial data and modelling results
<img src="../01_Hydrology/images/phd/Paper 4 - Figure 3.png" height="450" width="auto">

## Two component mixing model
> - **Write the water balance to express $Q(t)$, the total discharge at time t, as a function of $Q_{gw}(t)$, the groundwater exfiltration and $Q_{gl}(t)$, the glacier melt contribution (we neglect rain and evapotranspiration)**
> - $Q(t) = Q_{gw}(t) + Q_{gl}(t)$
> - **Write the solute mass balance to express $Q(t) EC(t)$ (the mass of solutes exiting the catchment per second) as a function of $Q_{gw}(t)$, $Q_{gl}(t)$ as well as $EC_{gw}$ and $EC_{gl}$, which are respectively the constant electrical conductivity values for groundwater and glacier melt. EC is a proxy for the concentration of solutes in water.**
> - $Q(t) * EC(t) = Q_{gw}(t)*EC_{gw} + Q_{gl}(t)*EC_{gl}$

## Total discharge as a function of $Q_{gw}(t)$

> - **By substituting $Q_{gl}(t)$ in one of the previous equations, express $Q(t)$ as a function of $Q_{gw}(t)$, $EC(t)$ and the constants $EC_{gw}$ and $EC_{gl}$**
> - $Q(t) = \frac{Q_{gw}(t)*(EC_{gw} - EC_{gl})}{EC(t) - EC_{gl}}$


## Modelled baseflow recession
<img src="../01_Hydrology/images/phd/Paper 4 - Figure 2.png" height="450" width="auto">

<!--
> - $Q(t)=Q_{gw}(t)*(EC_{gw}−EC_{gl})/(EC(t)−EC_{gl})$
$Q(t) = \frac{(EC_{gw}−EC_{gl})Q_{gw}(t)}{EC(t)−EC_{gl}}$

## GW exfiltration as a function of groundwater level
\[Q_{gw}(t) = V_{slow}(t)*T_{slow} + V_{fast}(t) T_{fast}\]
-->

<!--
## Recession discharge
\[Q_{recession}(t) = Q_{meas}(t_{end})*e^{\frac{t_{end} − t}{T_{slow}}}\]
-->

<!--
## Groundwater storage as a function of field GW measurements
\[L_{integral}(t) = L_{integral}(t − 1t) + P_n i+1 L_i(t)−L_i(t−1t) n \]
with $L_{integral}(t_{end}) = L_{residual}$


##  Total groundwater flow as a function of field GW measurements
\[Q_{gw}(t) = baseflow_{max} + A_{fast} × L_{integral}(t) × \Phi * T_{fast}\]


## Benchmark efficiency
\[E = 1 − P_t (Q_{meas}(t) − Q_{mod}(t))^2 P_t (Q_{meas}(t) − Q_{bench}(t))^2\]

## Verifying $A_{slow}$ with snowmelt recharge
\[V_{slow}(t) = V_{slow}(t−\Delta{t}) + (R(t) − \frac{V_{slow}(t−\Delta{t})}{T_{slow}})* \Delta{t}\]
-->

## Aquifer recharge with snowmelt

<img src="../01_Hydrology/images/phd/Paper 4 - Figure 6.png" height="450" width="auto">

## Mass balance verification for the infiltration rate

> - **Write the infiltration rate as a function of the storage volume and the exfiltration rate $Q_{gw}$**
> - We neglect evapotranspiration and recharge from rain 
> - $Q_{inf}(t) = dV(t)dt + Q_{gw}(t)$


## Seasonaly variable GW contribution
<img src="../01_Hydrology/images/phd/Paper 4 - Figure 5.png" height="450" width="auto">

## Discussion

Discuss the pros and cons of this approach.

In which cases could it work better?

# Modelling snowmelt

## Program you own model!

Follow instruction of [exercise 6: Snow model](http://www.geo.uzh.ch/en/units/h2k/Services/HBV-Model/Exercise-6.html) provided by Universy of Zürich

Download this article: [Teaching hydrological modeling with a user-friendly catchment-runoff-model software package](https://www.hydrol-earth-syst-sci.net/16/3315/2012/)

## Steps

Load the data into R

Name model parameters and initialize modelled variables

Make a "for" loop to run the model


## Good of fit metrics

Discuss different ways to assess the quality of your model.

How might different objective functions be used in specific contexts?

Add a goodness of fit measure to your routine and optimize the model according to this metric.


# Extras

## Irrigation exercise

Good exercise page 255, elements of physical hydrology


<!-- ## Prepare potential evapotranspiration series -->

<!-- Use the method of your choice to compute daily potential evapotraspiration. -->

<!-- Try energy balance calculations for potential evapotranspiration. See Elements of physical hydrology. -->

<!-- AirGR can also calculate it with the Oudin’s formula. The function is `Edaily_Oudin()` -->
